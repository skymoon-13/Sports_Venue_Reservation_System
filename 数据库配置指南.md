# 数据库配置指南

## 步骤一：安装 MySQL（如果还没有安装）

### 方法1：下载 MySQL 安装包
1. 访问 MySQL 官网：https://dev.mysql.com/downloads/mysql/
2. 下载 MySQL Community Server（Windows 版本）
3. 安装时记住设置的 root 密码

### 方法2：使用 XAMPP（推荐，简单易用）
1. 下载 XAMPP：https://www.apachefriends.org/
2. 安装后启动 XAMPP Control Panel
3. 点击 MySQL 旁边的 "Start" 按钮
4. 默认 root 密码为空（可以设置）

### 方法3：使用 MySQL 官方安装程序
- 下载 MySQL Installer for Windows
- 选择 "Developer Default" 或 "Server only"
- 安装过程中设置 root 密码

---

## 步骤二：创建数据库

### 方法1：使用命令行（推荐）

打开命令提示符或 PowerShell，执行：

```bash
# 登录 MySQL（会提示输入密码）
mysql -u root -p

# 进入 MySQL 后，执行以下 SQL 命令
CREATE DATABASE venue_booking CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

# 查看数据库是否创建成功
SHOW DATABASES;

# 退出 MySQL
EXIT;
```

### 方法2：使用 MySQL Workbench（图形界面）

1. 打开 MySQL Workbench
2. 连接到本地 MySQL 服务器
3. 点击 "Create a new schema" 按钮（或按 Ctrl+Shift+N）
4. 输入数据库名称：`venue_booking`
5. 设置字符集：`utf8mb4`
6. 设置排序规则：`utf8mb4_unicode_ci`
7. 点击 "Apply"

### 方法3：使用 phpMyAdmin（如果使用 XAMPP）

1. 打开浏览器访问：http://localhost/phpmyadmin
2. 点击左侧 "新建" 或 "New"
3. 数据库名称输入：`venue_booking`
4. 排序规则选择：`utf8mb4_unicode_ci`
5. 点击 "创建"

---

## 步骤三：修改配置文件

打开 `config.py` 文件，找到第 12-13 行的数据库配置：

```python
SQLALCHEMY_DATABASE_URI = os.environ.get('DATABASE_URL') or \
    'mysql+pymysql://root:password@localhost:3306/venue_booking?charset=utf8mb4'
```

**根据你的实际情况修改：**

### 如果 root 密码为空：
```python
SQLALCHEMY_DATABASE_URI = 'mysql+pymysql://root@localhost:3306/venue_booking?charset=utf8mb4'
```

### 如果 root 密码是 "123456"：
```python
SQLALCHEMY_DATABASE_URI = 'mysql+pymysql://root:123456@localhost:3306/venue_booking?charset=utf8mb4'
```

### 如果 MySQL 端口不是 3306（例如 3307）：
```python
SQLALCHEMY_DATABASE_URI = 'mysql+pymysql://root:password@localhost:3307/venue_booking?charset=utf8mb4'
```

### 如果创建了其他用户（例如用户名为 "myuser"，密码为 "mypass"）：
```python
SQLALCHEMY_DATABASE_URI = 'mysql+pymysql://myuser:mypass@localhost:3306/venue_booking?charset=utf8mb4'
```

**格式说明：**
```
mysql+pymysql://用户名:密码@主机:端口/数据库名?charset=utf8mb4
```

---

## 步骤四：测试数据库连接

### 方法1：运行初始化脚本测试

```bash
# 确保虚拟环境已激活
python init_db.py
```

如果看到 "✓ 数据库表创建成功"，说明连接成功！

### 方法2：运行应用测试

```bash
python app.py
```

如果应用能正常启动，没有数据库连接错误，说明配置成功。

---

## 常见问题

### 问题1：提示 "Access denied for user 'root'@'localhost'"

**解决方案：**
- 检查用户名和密码是否正确
- 如果忘记 root 密码，需要重置 MySQL 密码

### 问题2：提示 "Can't connect to MySQL server"

**解决方案：**
- 确认 MySQL 服务已启动
- 检查端口号是否正确（默认 3306）
- 如果使用 XAMPP，确保 MySQL 在 XAMPP Control Panel 中已启动

### 问题3：提示 "Unknown database 'venue_booking'"

**解决方案：**
- 确认数据库已创建
- 检查数据库名称拼写是否正确

### 问题4：提示 "No module named 'pymysql'"

**解决方案：**
```bash
pip install pymysql
```

---

## 快速检查清单

- [ ] MySQL 已安装并运行
- [ ] 数据库 `venue_booking` 已创建
- [ ] `config.py` 中的数据库连接信息已修改
- [ ] 已安装 PyMySQL：`pip install pymysql`
- [ ] 运行 `python init_db.py` 测试成功

完成以上步骤后，数据库就配置好了！

