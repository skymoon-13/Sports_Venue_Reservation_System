# 网络错误排查指南

如果一直提示"预约失败网络错误"，请按以下步骤排查：

## 第一步：检查后端服务是否运行

1. **查看终端/命令行窗口**
   - 应该看到类似这样的输出：
   ```
   * Running on http://0.0.0.0:5000
   * Debug mode: on
   ```

2. **如果没有运行，启动服务：**
   ```bash
   python app.py
   ```

## 第二步：检查访问地址

- 确保访问的是：`http://localhost:5000`
- 不要使用 `127.0.0.1` 或其他地址

## 第三步：使用诊断工具

1. 访问诊断页面：`http://localhost:5000/test`
2. 依次点击测试按钮
3. 查看每个测试的结果

## 第四步：检查浏览器控制台

1. 按 **F12** 打开开发者工具
2. 点击 **Console（控制台）** 标签
3. 查看是否有红色错误信息
4. 尝试提交预约，观察控制台输出

## 第五步：检查登录状态

1. 确保已登录（右上角显示用户名）
2. 如果未登录，先登录再尝试预约

## 第六步：常见问题

### 问题1：端口被占用

**解决方案：**
修改 `app.py` 最后一行：
```python
app.run(debug=True, host='127.0.0.1', port=5001)  # 改为5001或其他端口
```

然后访问：`http://localhost:5001`

### 问题2：CORS 错误

如果控制台显示 CORS 相关错误，可能是浏览器安全策略问题。

**解决方案：**
- 确保前后端在同一域名和端口
- 或者添加 CORS 支持（需要安装 flask-cors）

### 问题3：数据库连接失败

如果后端启动时提示数据库错误，检查：
1. MySQL 服务是否运行
2. `config.py` 中的数据库配置是否正确

## 快速测试命令

在浏览器控制台（F12）中执行：

```javascript
// 测试服务器连接
fetch('/').then(r => console.log('服务器:', r.ok ? '正常' : '异常'))

// 测试API
fetch('/api/venues').then(r => r.json()).then(d => console.log('场馆API:', d))
```

## 如果还是不行

请提供以下信息：
1. 浏览器控制台的完整错误信息（截图或复制）
2. 后端终端的输出信息
3. 访问的完整URL
4. 使用的浏览器类型和版本

